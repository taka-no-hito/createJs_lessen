# 推奨環境
- node:v6.11.3以上
- gulp:v3.9.1

# はじめに
本開発環境をクローン後、開発環境に移動してからタスクランナーを実行してください。  


# 依存ライブラリのインストール
作業フォルダで以下コマンドを実行する。
```
npm install
```  
_※ `yarn install`だと一部正常に起動できない場合があります。_


# gulpタスク
## 開発コマンド
下記のコマンドの実行で、ビルド&監視がスタートされ、`/dev/`内にコードが生成されます。  
```
gulp
```

## 納品コマンド
下記のコマンドの実行で、納品用のファイルが`/product/`内に生成されます。  
```
gulp product
```
また`product`は下記のような点が`dev`と異なります。  

- sourcemapsの削除  
- 画像の圧縮  
- css,jsのminify化  
- js内のconsoleの削除  

# ディレクトリ構成  
各階層は下記の通りです。  

```
project_template/  
  ├ config.js          gulpfile.js内で使用される設定ファイル  
  ├ gulpfile.js        gulpの設定ファイル  
  ├ package.json       パッケージリスト  
  ├ README.md          本ファイル  
  ├ /src/              開発フォルダ  
  ├ /dev/              出力フォルダ  
  └ /product/          納品用フォルダ  
  
```

# 開発にあたって
本環境の詳細は下記の通りとなります。  
_※あくまでデフォルトでの設定ですので、変更、拡張後は適宜本ファイルの修正お願いいたします。_  

## HTMLについて
本環境では__EJS__を採用しております。  
また、HTMLにコンパイルさせる際に__gulp-html-beautify__を使用し、HTMLの整形を行なっております。  
整形の設定を変更する場合は、直接_gulpfile.js_を変更してください。  

### 作業フォルダ
開発環境は`/src/ejs/`内です。  
共通パーツは`/src/ejs/global/`を参照してください。  
コンパイルされたのもが`/dev/`内へ`/src/ejs/`内と同階層で出力されます。  

### 命名規則
本プロジェクトではBEM風の命名規則を推奨しております。  
特殊なルールにつきましては下記に記載いたします。  
#### 接頭語について
本プロジェクトでは接頭語の付与を推奨しております。  
つなぎ文字は__-(ハイフン)__です。  
通常はページ名を接頭語に用いますが、特殊例を下記に記載いたします。  

```
・header-           headerの接頭語  
・footer-           headerの接頭語  
・c-                コンポーネントを表す接頭語。※複数ページで使用する場合はこの接頭語を用いてください。  
・is-               状態を表す接頭語。  
```
#### 文字のつなぎについて
正規のBEM方式異なり各要素は__\_(アンダーバー)__一つで繋いでおります。  
また、要素名が複数の語句になる場合はキャメル型を用いています。  
例）  top-blockBlock_element-modifier  
#### jsのフッククラスについて
jsのフックとしてクラスを用いる場合は接頭語に__js__を接頭語として付与してください。  
その後はキャメル型でつないでください。  
例）  js-menuBtn  
また、このクラスににはスタイルを当てないでください。  



## CSSについて
本環境では__scss__を採用しております。  

### 作業フォルダ
開発環境は`/src/scss/`内です。  
各ファイルの詳細は下記を参照してください。  

```
scss/  
  ├ core/                        各種設定ファイル  
  |  ├ _extend.scss              extend元の保存先  
  |  ├ _keyframes.scss           アニメーション用のkeyframesの保存先  
  |  ├ _media.scss               メディアクエリ用の設定ファイル  
  |  ├ _mixin.scss               mixin用の設定ファイル  
  |  ├ _reset.scss               リセット用のscss  
  |  └ _variable.scss            変数設定用（※使用頻度高）  
  ├ fonts/                       webフォント呼び出し設定  
  ├ global/                      全ページ共通設定
  |  ├ _common.scss              各種デフォルトの設定  
  |  ├ _footer.scss              共通footer  
  |  ├ _header.scss              共通header  
  |  └ _reservationModal.scss    予約用のモーダル  
  ├ component/                   コンポーネント化したファイルの保存先
  |  └ _components.scss          複数ページで用いるコンポーネント保存先  
  ├ libs/                        プラグイン等で必要なscssの保存先  
  ├ page/                        各種ページのscss保存先  
  └ style.scss                   import用css  
  
```

コンパイルされたのもが`/dest/css/`内へ出力されます。  
本環境では1枚の`style.css`として出力します。  


### ベンダープレフィックスについて
本環境では__autoprefixer__を導入しております。  
そのため基本的にベンダープレフィックスの記述は不要となります。  
ごく稀にベンダープレフィックスが付与されない場合がございます。  
ブラウザ確認等で正常に表示されない場合は適宜付与してください。  
デフォルトの対象ブラウザは__last 2 versions__(最後の2バージョンのブラウザ)となっております。  
案件に合わせて適宜変更してください。  

### ソーソマップについて
本環境では__sourcemaps__が生成されます。  
これによりchrome等のデベロッパーツーツにてスタイルが記述されているファイル名と行数が表示されます。  
scssを入れ子で記述してしまうと行数が正常に出ない場合がございます。  
また、`gulp product`コマンドではsourcemapsは出力されません。  

### scssの記述方法について
基本的には自由に書いていただいて問題ないのですが、sourcemaps有効に活用するためには下記のような書き方をおすすめします。  

```
//scss
.top {
  color: black;
  &-blockBlock {
    color: red;
    &_element {
      color: blue;
    }
  }
}

//出力css
.top { color: black; }
.top-blockBlock { color: red; }
.top-blockBlock_element { color: blue; }
```

### _variable.scssファイルについて
本環境では多くの変数を使用しております。  
下記のようなものは基本的には変数化して一括管理するようにお願いいたします。  

- カラーコード  
- opacity等の数値  
- font (family / weight)  
- imgパス  
- innerサイズ  
- breakpoint  

### style.scssファイルについて
本ファイルにて各ファイルを@importして出力を行なっております。  
fonts、libs、page内に新規でファイルを作成した場合は自動的にimportされます。  
core内につきましては読み込みの順番によりエラーが発生しますので順番を指定しております。  
呼び出し順を指定したい場合は個別に呼び出すことをお勧めいたします。  


## JSについて
本環境では__webpack__を導入しております。  

### 作業フォルダ
開発環境は`/src/js/`内です。  
各ファイルの詳細は下記を参照してください。  

```
js/  
  ├ module/                   各種モジュールファイルの保存先  
  ├ libs/                     フラグイン等保存先  
  └ main.js                   実行用js  
  
```

### 方針について
設計方針としましてjsはページ毎ではなく、__機能毎__に作成し、`/src/js/module/`内に保存してください。  
実行に関しては`src/js/main.js`で__import__にて呼び出し、実行してください。  
webpackの機能によりjsファイルは１つにまとめられ`/dev/js/bundle.js/`として出力されます。  

### moduleファイルの書き方
モジュールファイルは一つの関数で括り、その中に機能を記述してください。  
関数内の記述方法は基本的に自由となっております。  
内部に新しく関数を作成する場合は処理の概要をコメントにて記載してください。  
モジュールファイルの雛形を下記に記述します。  

```
// 関数名 : 説明文
export default function 関数名() {
  //処理
}
```

### main.jsファイルの書き方
moduleやlibsに保存されたファイルは基本的にはここで呼び出し実行いたします。  
また、jQueryに関しましては呼び出し不要です。  
呼び出し方は下記を参考にしてください。  

```
// プラグインの呼び出し
import "./libs/hogehoge.js"
// モジュールの呼び出し
import 関数名 from "./module/fugafuga";

//実行方法
関数名();

```

### ES2015について
webpack導入に伴い、babelも導入しております。  
そのため、__ES2015対応__となっております。  


## 画像について
本環境のでは__画像の圧縮も行えます__。  
画像の圧縮はビルドに時間がかかるため通常の`gulp`コマンドでは行なっておりません。  
納品用の`gulp product`のみ行なっております。  
圧縮率は__gulpfile.js__にて調整してください。  
画像の保存先は`/src/img/`内です。  
タスクランナーを起動し、画像を追加すると__圧縮され__`/product/img`内へ移動します。  

## フォントについて
フォントにの保存先は`/src/fonts/`内です。  
タスクランナーが起動すると、`/dev/fonts/`内へ移動します。  

## 目次ファイルについて
本サイトの目次ファイルは`/src/ejs/pagelist/index.ejs`になっております。  
最上部の配列にページ情報を追加いただくと自動的に出力されます。  
本番公開の前に削除をお忘れなきようご注意ください。  

## git管理について
本環境では`/node_modules/`以外に`/dev/`、`/product/`につきましてもgit管理から外しております。  
理由といたしましては、css,js共に１つのファイルとして出力される為、コンフリクトを避ける為です。  
よって、gitプル後は必ずタスクランナーを実行してください。  
gitの管理は`.gitignore`で行なっておりますので適宜変更お願いいたします。  

# デフォルトで導入されているライブラリ
- jQuery3.2.1以上（package.jsonにて管理）


